$('#message_body').val('');
$('.chat-area').append("<%= escape_javascript(render('chats/guest', message: @message)) %>");

<% @bot_messages.each do |bot_message| %>
<%# 会話している風にするため意図的にbotの発言を遅らせる %>
$('.chat-area').delay(500).queue(function() {
  $(this).append("<%= escape_javascript(render('chats/bot', message: bot_message, token: @bot.try(:token), message_id: bot_message.id)) %>")
    .dequeue();

  <% if bot_message&.answer&.decision_branches&.present? || bot_message&.similar_question_answers&.present? %>
    disable_question_field();
  <% else %>
    enable_question_field();
  <% end %>

  if (typeof window.initMessageRatingButtons === "function") {
    initMessageRatingButtons();
  }
});
<% end %>

$(window).scrollTop($('.chat-area').height());
